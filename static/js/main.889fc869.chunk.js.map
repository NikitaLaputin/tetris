{"version":3,"sources":["components/buttons/button.module.css","components/field/field.module.css","components/info/info.module.css","components/game/game.module.css","components/display/display.module.css","components/version/styles.module.css","utils/consts.js","utils/index.js","redux/selectors/index.js","components/helpers/draw-text.js","hooks/use-canvas.js","components/helpers/draw-block.js","components/helpers/use-previous.js","hooks/use-render-areas.js","components/field/index.js","components/helpers/draw-field.js","components/helpers/draw-high-score.js","components/helpers/draw-game-over.js","components/next-block/index.js","components/helpers/draw-tetrimino.js","hooks/use-interval.js","redux/ducks/field.js","redux/ducks/game-state.js","components/info/index.js","components/display/index.js","hooks/use-key-press.js","components/buttons/option-button.js","components/buttons/start.js","components/buttons/pause.js","redux/ducks/active-block.js","components/buttons/main-button.js","components/buttons/left.js","components/buttons/right.js","components/buttons/rotate.js","components/buttons/down.js","components/buttons/drop.js","components/buttons/index.js","hooks/use-tab-change.js","components/game/index.js","redux/reduser/index.js","redux/ducks/next-block.js","redux/ducks/high-score.js","redux/middlewares/game-state-checker.js","redux/middlewares/block-locker.js","redux/store/index.js","redux/middlewares/pause-toggle.js","redux/middlewares/move-down.js","redux/middlewares/collision-check.js","redux/middlewares/destroy-row.js","localstorage/index.js","components/version/index.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","SHAPES","I","J","L","O","S","T","Z","colors","INVISIBLE_ROWS","SHAPE_POSITION","DEFAULT_SHAPE","shape","position","PIXEL_RATIO","window","devicePixelRatio","BLOCK_SIDE","getLeftPoint","matrix","Math","min","map","row","arr","findIndex","val","length","getRightPoint","max","reduce","acc","i","getBottomPoint","canMoveDown","field","block","x","y","cell","between","value","start","finish","mergeMatrix","target","ri","ci","collide","getFiledHeight","filter","calcNewScore","score","level","lines","randomizeShapes","sort","round","random","getNewTetrimino","randomArray","letter","locked","calcLevel","ceil","calcSpeed","pow","Timeout","keys","keyData","set","key","wait","clear","setTimeout","Date","getTime","paused","clearTimeout","pause","resume","Interval","keysTimeouts","ms","setInterval","clearInterval","getShapeColor","darkenColor","color","percent","split","floor","join","lightenColor","getGhostBlock","isMobileDevice","orientation","navigator","userAgent","indexOf","clearArea","ctx","area","forEach","rowI","cellI","clearRect","blockSelector","createSelector","state","activeBlock","fieldSelector","slice","levelSelector","gameState","scoreSelector","highScoreSelector","highScore","linesSelector","gameStateSelector","gameStatusSelector","status","speedSelector","speed","nextBlockSelector","nextBlock","_","width","height","side","ghostBlockSelector","activeFieldSelector","ghostBlock","fieldWithGhostBlock","drawText","size","text","textAlign","lineWidth","font","strikeStyle","strokeText","fillStyle","fillText","useCoolCanvas","draw","style","cleanup","canvasWidth","useMemo","canvasHeigth","ref","useRef","useEffect","current","getContext","requestAnimationFrame","drawBlock","ghost","beginPath","strokeStyle","rect","stroke","lingrad","createLinearGradient","colorGradStart","colorGradEnd","addColorStop","fillRect","usePrevious","useRenderAreas","prevArea","newArea","oldArea","renderArea","Array","fill","memo","useSelector","canvasStyle","borderRadius","fieldRenderArea","fieldClearArea","fieldCanvas","useCanvas","useCallback","col","drawField","textCanvas","center","res","concat","drawHighScore","drawGameOver","includes","background","zIndex","className","styles","canvas","startingRow","offset","drawTetrimino","now","MERGE","defaultState","mergeField","payload","type","PAUSE","RESET","lastAction","useState","time","setTime","callback","remaining","setRemaining","startTime","setStartTime","setPaused","savedCallback","reset","interval","useInterval","canvasStyles","info","mouseUp","mouseDown","isKeyClicked","targetKey","toLowerCase","isButtonClicked","targetButton","e","contains","useKey","continious","frequency","delay","pressed","setPressed","onDown","preventDefault","onUp","addEventListener","removeEventListener","timeout","btnRef","dispatch","useDispatch","useKeyPress","ROTATE","MOVE_RIGHT","MOVE_LEFT","MOVE_DOWN","SET_NEW_TETRIMINO","LOCK","UNLOCK","DROP","MOVE_LOCK","MOVE_UNLOCK","moveDown","rotate","unlock","drop","movementLock","movementUnlock","tabIndex","gridArea","useTabChange","document","combineReducers","action","movementLocked","newLevel","newSpeed","a","b","alwaysDispatch","actions","middlewares","store","next","getState","speedBefore","speedAfter","canMoveLeft","canMoveRight","tetrimino","rotated","index","flipMatrix","reverse","maxDelta","deg","PI","delta","cos","dx","abs","rotateTetrimino","isMovingDown","dispatchMerge","heightBefore","heightAfter","rows","destroyFullRows","destroyRow","setNewTetrimino","setNewHighScore","serializedHighScore","JSON","stringify","localStorage","setItem","saveHighScore","getItem","parse","err","loadHighScore","enhancer","applyMiddleware","__REDUX_DEVTOOLS_EXTENSION__","createStore","reducer","version","App","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","getElementById","URL","process","href","origin","fetch","response","contentType","headers","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.889fc869.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttons-container\":\"button_buttons-container__1955V\",\"button-container\":\"button_button-container__39fQB\",\"tetris-button\":\"button_tetris-button__eItG2\",\"tetris-option-button\":\"button_tetris-option-button__3Kl3U\",\"tetris-button__active\":\"button_tetris-button__active__26vlf\",\"tetris-option-button__active\":\"button_tetris-option-button__active__1vvTZ\",\"tetris-button__dark\":\"button_tetris-button__dark__2RK1f\",\"tetris-button__dark__active\":\"button_tetris-button__dark__active__1fMOD\",\"tetris-option-button__dark\":\"button_tetris-option-button__dark__1HGSl\",\"tetris-option-button__dark__active\":\"button_tetris-option-button__dark__active__W25rR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas-container\":\"field_canvas-container__1U1ww\",\"canvas-container__dark\":\"field_canvas-container__dark__2GoQP\",\"canvas-container__light\":\"field_canvas-container__light__25KvA\",\"text\":\"field_text__504n6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info-column\":\"info_info-column__2XUG0\",\"info\":\"info_info__3GloF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tetris-container\":\"game_tetris-container__2gHB5\",\"tetris-container__light\":\"game_tetris-container__light__11ybi\",\"tetris-container__dark\":\"game_tetris-container__dark__3bHhN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"display-container\":\"display_display-container__NotnD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"version\":\"styles_version__3zm86\"};","export const SHAPES = {\n  I: [\n    [0, 0, 1, 0, 0],\n    [0, 0, 1, 0, 0],\n    [0, 0, 1, 0, 0],\n    [0, 0, 1, 0, 0]\n  ],\n  J: [\n    [0, 2, 0],\n    [0, 2, 0],\n    [2, 2, 0]\n  ],\n  L: [\n    [0, 3, 0],\n    [0, 3, 0],\n    [0, 3, 3]\n  ],\n  O: [\n    [4, 4],\n    [4, 4]\n  ],\n  S: [\n    [0, 5, 5],\n    [5, 5, 0],\n    [0, 0, 0]\n  ],\n  T: [\n    [0, 0, 0],\n    [6, 6, 6],\n    [0, 6, 0]\n  ],\n  Z: [\n    [7, 7, 0],\n    [0, 7, 7],\n    [0, 0, 0]\n  ]\n};\nexport const SHAPES_LIST = 'IJLOSTZ';\nexport const RIGHT = 'RIGHT';\nexport const LEFT = 'LEFT';\nexport const DOWN = 'DOWN';\nexport const DEFAULT_POSITION = [3, 0];\n\nconst white = 'rgba(255, 255, 255, 1)';\nconst teal = 'rgba(0, 243, 255, 1)';\nconst blue = 'rgba(0, 90, 255, 1)';\nconst orange = 'rgba(255, 118, 0, 1)';\nconst yellow = 'rgba(255, 247, 0, 1)';\nconst green = 'rgba(0, 255, 102, 1)';\nconst violet = 'rgba(133, 0, 255, 1)';\nconst red = 'rgba(255, 0, 0, 1)';\n\nexport const colors = [white, teal, blue, orange, yellow, green, violet, red];\nexport const IN_PROGRESS = 'Running';\nexport const GAME_OVER = 'GAME OVER';\nexport const INVISIBLE_ROWS = 4;\nexport const SHAPE_POSITION = {\n  I: [3, INVISIBLE_ROWS - 4],\n  J: [3, INVISIBLE_ROWS - 3],\n  L: [3, INVISIBLE_ROWS - 3],\n  O: [4, INVISIBLE_ROWS - 2],\n  S: [3, INVISIBLE_ROWS - 3],\n  T: [3, INVISIBLE_ROWS - 3],\n  Z: [3, INVISIBLE_ROWS - 3]\n};\nexport const MAX_LEVELS = 15;\nexport const GAME_PAUSED = 'GAME_PAUSED';\nexport const NOT_STARTED = 'NOT_STARTED';\nexport const LOCK_DELAY = 500;\nexport const DEFAULT_SHAPE = {\n  shape: SHAPES.I,\n  position: SHAPE_POSITION.I\n};\n\nexport const PIXEL_RATIO = (() => window.devicePixelRatio)();\nexport const BLOCK_SIDE = 20 * PIXEL_RATIO;\n","import {\n  INVISIBLE_ROWS,\n  SHAPES_LIST,\n  SHAPES,\n  SHAPE_POSITION,\n  MAX_LEVELS,\n  colors,\n  BLOCK_SIDE\n} from \"./consts\";\n\nconst flipMatrix = matrix =>\n  matrix[0].map((_, index) => matrix.map(row => row[index]));\n\nconst firstNonzero = arr =>\n  !~arr.findIndex(val => val) ? arr.length - 1 : arr.findIndex(val => val);\n\nconst lastNonzero = arr => arr.reduce((acc, val, i) => (val ? i : acc), 0);\n\nconst getLeftPoint = matrix =>\n  Math.min(...matrix.map(row => firstNonzero(row)));\n\nconst getRightPoint = matrix =>\n  Math.max(...matrix.map(row => lastNonzero(row)));\n\nconst getBottomPoint = matrix =>\n  Math.max(\n    ...matrix.map((row, i) => row.reduce((acc, val) => (val ? i : acc), 0))\n  );\n\nexport const rotate = matrix => {\n  return flipMatrix(matrix.slice().reverse());\n};\n\nexport const canMoveLeft = (field, block) => {\n  const { shape, position } = block;\n  const [x, y] = position;\n  for (let row = 0; row < shape.length; row++)\n    for (let cell = 0; cell < shape[row].length; cell++)\n      if (\n        shape[row][cell] &&\n        (x + getLeftPoint(shape) <= 0 ||\n          (field[row + y] && field[row + y][cell + x - 1]))\n      )\n        return false;\n  return true;\n};\n\nexport const canMoveRight = (field, block) => {\n  const { shape, position } = block;\n  const [x, y] = position;\n  for (let row = 0; row < shape.length; row++)\n    for (let cell = 0; cell < shape[row].length; cell++)\n      if (\n        shape[row][cell] &&\n        (x + getRightPoint(shape) >= 9 ||\n          (field[row + y] && field[row + y][cell + x + 1]))\n      )\n        return false;\n  return true;\n};\n\nexport const canMoveDown = (field, block) => {\n  const { shape, position } = block;\n  const [x, y] = position;\n  for (let row = 0; row < shape.length; row++)\n    for (let cell = 0; cell < shape[row].length; cell++)\n      if (\n        shape[row][cell] &&\n        (y + getBottomPoint(shape) >= field.length - 1 ||\n          (field[row + y + 1] && field[row + y + 1][cell + x]))\n      )\n        return false;\n  return true;\n};\n\nconst between = (value, start, finish) => value > start && value < finish;\n\nexport const mergeMatrix = (target, matrix, position) =>\n  target.map((row, ri) =>\n    row.map((cell, ci) =>\n      between(ri, position[1] - 1, position[1] + matrix.length) &&\n      between(\n        ci,\n        position[0] - 1,\n        position[0] + matrix[ri - position[1]].length\n      ) &&\n      matrix[ri - position[1]][ci - position[0]]\n        ? matrix[ri - position[1]][ci - position[0]]\n        : cell\n    )\n  );\n\nexport const collide = (field, block) => {\n  const { shape, position } = block;\n  const [x, y] = position;\n  for (let row = 0; row < shape.length; row++)\n    for (let cell = 0; cell < shape[row].length; cell++)\n      if (\n        shape[row][cell] &&\n        (x + getLeftPoint(shape) < 0 ||\n          x + getRightPoint(shape) > 9 ||\n          y + getBottomPoint(shape) >= 20 + INVISIBLE_ROWS ||\n          (field[row + y] && field[row + y][cell + x]))\n      )\n        return true;\n  return false;\n};\n\nexport const rotateTetrimino = (field, tetrimino) => {\n  const { shape, position, locked } = tetrimino;\n  let rotated = { shape: rotate(shape), position, locked };\n  const maxDelta = Math.floor(shape.length / 2);\n  if (!collide(field, rotated)) {\n    return rotated;\n  }\n  for (let deg = Math.PI / 2; deg <= Math.PI * 2; deg *= 2) {\n    const delta = Math.floor(Math.cos(deg));\n    for (let dx = delta; dx !== 0 && Math.abs(dx) <= maxDelta; dx += delta) {\n      rotated = {\n        ...rotated,\n        position: [position[0] + dx, position[1]]\n      };\n      if (!collide(field, rotated)) {\n        return rotated;\n      }\n    }\n  }\n  return tetrimino;\n};\n\nconst isFullRow = arr => arr && arr.length === arr.filter(val => val).length;\n\nconst isNullRow = arr => !arr.filter(val => val).length;\n\nexport const destroyFullRows = matrix => {\n  const heightBefore = getFiledHeight(matrix);\n  matrix = matrix\n    .map((row, i) =>\n      isFullRow(row) ? new Array(matrix[i].length).fill(0) : row\n    )\n    .sort(row => (isNullRow(row) ? -1 : 0));\n  const heightAfter = getFiledHeight(matrix);\n  const rows = heightBefore - heightAfter;\n  return {\n    matrix,\n    rows\n  };\n};\n\nexport const getFiledHeight = field =>\n  field.reduce((acc, row) => (row.filter(val => val).length ? ++acc : acc), 0);\n\nexport const calcNewScore = ({ score, level, lines }) => {\n  switch (lines) {\n    case 1:\n      return score + 40 * (level + 1);\n    case 2:\n      return score + 100 * (level + 1);\n    case 3:\n      return score + 300 * (level + 1);\n    case 4:\n      return score + 1200 * (level + 1);\n    default:\n      return score;\n  }\n};\n\nconst randomizeShapes = () =>\n  [...SHAPES_LIST].sort(() => Math.round(Math.random() * 2 - 1));\n\nexport const getNewTetrimino = (() => {\n  let i = 0;\n  let randomArray = randomizeShapes();\n  const getNextShape = () => {\n    const letter = randomArray[i];\n    i++;\n    if (i > 6) {\n      i = 0;\n      randomArray = randomizeShapes();\n    }\n    const shape = SHAPES[letter];\n    const position = SHAPE_POSITION[letter];\n    return { shape, position, locked: false };\n  };\n  return getNextShape;\n})();\n\nexport const calcLevel = lines => Math.min(Math.ceil(lines / 10), MAX_LEVELS);\n\nexport const calcSpeed = level =>\n  Math.round(Math.pow(0.8 - (level - 1) * 0.007, level - 1) * 1000 * 100000) /\n  1000000;\n\nexport const Timeout = (() => {\n  const keys = {};\n  const keyData = {};\n  const set = (key, wait) => {\n    clear(key);\n    keys[key] = setTimeout(key, wait);\n    keyData[key] = { start: new Date().getTime(), paused: false, wait };\n  };\n\n  const clear = key => {\n    if (keys[key]) {\n      clearTimeout(keys[key]);\n      delete keys[key];\n      delete keyData[key];\n    }\n  };\n\n  const paused = key => keys[key] && keyData[key] && keyData[key].paused;\n\n  const pause = key => {\n    if (!keys[key]) return;\n    if (paused(key)) return;\n    clearTimeout(keys[key]);\n    const start = new Date().getTime();\n    const wait = keyData[key].wait - (start - keyData[key].start);\n\n    keyData[key] = { start, wait, paused: true };\n  };\n\n  const resume = key => {\n    if (!keys[key]) return;\n    if (!paused(key)) return;\n\n    set(key, keyData[key].wait);\n  };\n\n  return {\n    set,\n    clear,\n    pause,\n    resume\n  };\n})();\n\nexport const Interval = (() => {\n  const keys = {};\n  const keyData = {};\n  const keysTimeouts = {};\n  const set = (key, ms) => {\n    clear(key);\n    keys[key] = setInterval(() => {\n      key();\n      keyData[key] = {\n        start: new Date().getTime(),\n        paused: false,\n        ms,\n        wait: 0\n      };\n    }, ms);\n    keyData[key] = { start: new Date().getTime(), paused: false, ms, wait: 0 };\n  };\n\n  const clear = key => {\n    if (keys[key]) {\n      clearInterval(keys[key]);\n      clearTimeout(keysTimeouts[key]);\n      delete keys[key];\n      delete keyData[key];\n    }\n  };\n\n  const paused = key => keys[key] && keyData[key] && keyData[key].paused;\n\n  const pause = key => {\n    if (!keys[key]) return;\n    if (paused(key)) return;\n    clearInterval(keys[key]);\n    clearTimeout(keysTimeouts[key]);\n    const start = new Date().getTime();\n    const wait = keyData[key].ms - (start - keyData[key].start);\n\n    keyData[key] = { ...keyData[key], start, wait, paused: true };\n  };\n\n  const resume = key => {\n    if (!keys[key]) return;\n    if (!paused(key)) return;\n    keysTimeouts[key] = setTimeout(() => {\n      key();\n      set(key, keyData[key].ms);\n    }, keyData[key].wait);\n  };\n\n  return {\n    set,\n    clear,\n    pause,\n    resume\n  };\n})();\n\nexport const getShapeColor = shape =>\n  colors[\n    shape.reduce(\n      (acc, row) =>\n        acc ? acc : row.reduce((acc, cell) => (cell ? cell : acc), 0),\n      0\n    )\n  ];\n\nexport const darkenColor = (color, percent = 0) =>\n  color\n    .split(\"(\")\n    .map((val, i) =>\n      i\n        ? val\n            .split(\", \")\n            .map((val, i, arr) =>\n              i < arr.length - 1\n                ? Math.max(\n                    Math.min(255, Math.floor((val * (100 - percent)) / 100)),\n                    0\n                  )\n                : val\n            )\n            .join(\", \")\n        : val\n    )\n    .join(\"(\");\n\nexport const lightenColor = (color, percent = 0) =>\n  color\n    .split(\"(\")\n    .map((val, i) =>\n      i\n        ? val\n            .split(\", \")\n            .map((val, i, arr) =>\n              i < arr.length - 1\n                ? Math.max(\n                    Math.min(\n                      255,\n                      Math.floor(((255 - val) * percent) / 100 + +val)\n                    ),\n                    0\n                  )\n                : val\n            )\n            .join(\", \")\n        : val\n    )\n    .join(\"(\");\n\nexport const getGhostBlock = (field, block) => {\n  while (canMoveDown(field, block)) {\n    const { position } = block;\n    block = {\n      ...block,\n      position: [position[0], position[1] + 1]\n    };\n  }\n  return block;\n};\n\nexport const isMobileDevice = (() =>\n  typeof window.orientation !== \"undefined\" ||\n  navigator.userAgent.indexOf(\"IEMobile\") !== -1)();\n\nexport const timeFromMs = ms =>\n  `${Math.floor(ms / 60)}:${(\"0\" + Math.floor(ms % 60)).slice(-2)}`;\n\nexport const clearArea = (ctx, area, position = [0, 0]) => {\n  area.forEach((row, rowI) =>\n    row.forEach((cell, cellI) => {\n      if (cell) {\n        ctx.clearRect(\n          (cellI + position[0]) * BLOCK_SIDE,\n          (rowI + position[1]) * BLOCK_SIDE,\n          BLOCK_SIDE,\n          BLOCK_SIDE\n        );\n      }\n    })\n  );\n};\n\nexport const getDifference = (newArea, oldArea) => {\n  if (!oldArea) {\n    return {\n      renderArea: newArea,\n      clearArea: newArea.map(row => new Array(row.length).fill(0))\n    };\n  }\n\n  const renderArea = newArea.map((row, ri) =>\n    row.map((cell, ci) => {\n      if (!cell) return cell;\n\n      if (ri < 0 || ri >= oldArea.length || ci < 0 || ci >= oldArea[0].length) {\n        return cell;\n      }\n\n      return cell === oldArea[ri][ci] ? 0 : cell;\n    })\n  );\n\n  const clearArea = newArea\n    ? oldArea.map((row, ri) =>\n        row.map((cell, ci) => {\n          if (\n            ri < 0 ||\n            ri >= newArea.length ||\n            ci < 0 ||\n            ci >= newArea[0].length\n          ) {\n            return cell;\n          }\n\n          return cell !== newArea[ri][ci] ? cell : 0;\n        })\n      )\n    : oldArea.map(row => new Array(row.length).fill(0));\n\n  return {\n    renderArea,\n    clearArea\n  };\n};\n","import { getGhostBlock, mergeMatrix } from '../../utils';\nimport { createSelector } from 'reselect';\nimport { INVISIBLE_ROWS } from '../../utils/consts';\n\nexport const blockSelector = createSelector(\n  state => state.activeBlock,\n  block => {\n    const { shape, locked } = block;\n    const coloredShape = shape.map(row =>\n      row.map(cell => (cell ? cell + 8 * !!locked : 0))\n    );\n\n    return {\n      shape: coloredShape,\n      locked,\n      position: [block.position[0], block.position[1] - INVISIBLE_ROWS]\n    };\n  }\n);\n\nexport const fieldSelector = createSelector(\n  state => state.field,\n  field => field.slice(INVISIBLE_ROWS)\n);\n\nexport const levelSelector = state => state.gameState.level;\n\nexport const scoreSelector = state => state.gameState.score;\n\nexport const highScoreSelector = state => state.highScore;\n\nexport const linesSelector = state => state.gameState.lines;\n\nexport const gameStateSelector = state => state.gameState;\n\nexport const gameStatusSelector = state => gameStateSelector(state).status;\n\nexport const gameLastActionSelector = state =>\n  gameStateSelector(state).lastAction;\n\nexport const speedSelector = state => gameStateSelector(state).speed;\n\nexport const nextBlockSelector = createSelector(\n  state => state.nextBlock,\n  (_, width, height, side) => ({ width, height, side }),\n  (nextBlock, { width, height, side }) => {\n    const { shape } = nextBlock;\n    const x =\n      Math.floor(((width - shape[0].length * side) / (2 * side)) * 10) / 10;\n\n    const y =\n      Math.floor(((height - shape.length * side) / (2 * side)) * 10) / 10;\n\n    const position = [x, y];\n\n    return { shape, position };\n  }\n);\n\nexport const ghostBlockSelector = createSelector(\n  fieldSelector,\n  blockSelector,\n  (field, block) => {\n    const { shape, position } = getGhostBlock(field, block);\n    const ghostBlockShape = shape.map(row => row.map(cell => (cell ? 'g' : 0)));\n\n    return { shape: ghostBlockShape, position };\n  }\n);\n\nexport const activeFieldSelector = createSelector(\n  blockSelector,\n  ghostBlockSelector,\n  fieldSelector,\n  (block, ghostBlock, field) => {\n    const fieldWithGhostBlock = mergeMatrix(\n      field,\n      ghostBlock.shape,\n      ghostBlock.position\n    );\n    const activeField = mergeMatrix(\n      fieldWithGhostBlock,\n      block.shape,\n      block.position\n    );\n\n    return activeField;\n  }\n);\n","import { PIXEL_RATIO } from \"../../utils/consts\";\n\nexport default function drawText({ ctx, size, position, color, text }) {\n  // ctx.fillStyle = \"#0b0d10\";\n  // ctx.fillRect(0, 0, 200 * PIXEL_RATIO, 400 * PIXEL_RATIO);\n  const [x, y] = position;\n  ctx.textAlign = \"center\";\n  ctx.lineWidth = 3 * PIXEL_RATIO;\n  ctx.font = `${size * PIXEL_RATIO}px monospace`;\n  ctx.strikeStyle = \"black\";\n  ctx.strokeText(text, x, y, 190 * PIXEL_RATIO);\n  ctx.fillStyle = color;\n  ctx.fillText(text, x, y, 190 * PIXEL_RATIO);\n}\n","import React, { useRef, useEffect, useMemo } from \"react\";\nimport { PIXEL_RATIO } from \"../utils/consts\";\n\nconst useCoolCanvas = (draw, style, cleanup) => {\n  const { width, height } = style;\n  const canvasWidth = useMemo(() => width * PIXEL_RATIO, [width]);\n  const canvasHeigth = useMemo(() => height * PIXEL_RATIO, [height]);\n  const ref = useRef(null);\n\n  useEffect(() => {\n    const ctx = ref.current && ref.current.getContext(\"2d\");\n\n    if (!ctx) return;\n\n    window.requestAnimationFrame(() => draw(ctx));\n\n    return () => cleanup && window.requestAnimationFrame(() => cleanup(ctx));\n  }, [draw, cleanup]);\n\n  const canvas = (\n    <canvas ref={ref} width={canvasWidth} height={canvasHeigth} style={style} />\n  );\n\n  return canvas;\n};\n\nexport default useCoolCanvas;\n","import { darkenColor } from \"../../utils\";\nimport { PIXEL_RATIO, BLOCK_SIDE } from \"../../utils/consts\";\n\nexport default function drawBlock({\n  ctx,\n  position,\n  color,\n  locked = false,\n  ghost = false\n}) {\n  const [x, y] = position;\n\n  if (ghost) {\n    ctx.beginPath();\n    ctx.strokeStyle = \"#858fa5\";\n    ctx.lineWidth = 2 * PIXEL_RATIO;\n    ctx.rect(\n      x + 2 * PIXEL_RATIO,\n      y + 2 * PIXEL_RATIO,\n      BLOCK_SIDE - 4 * PIXEL_RATIO,\n      BLOCK_SIDE - 4 * PIXEL_RATIO\n    );\n    ctx.stroke();\n  } else {\n    const lingrad = ctx.createLinearGradient(\n      x,\n      y,\n      x + BLOCK_SIDE,\n      y + BLOCK_SIDE\n    );\n    const colorGradStart = color;\n    const colorGradEnd = darkenColor(color, 35);\n    lingrad.addColorStop(0, colorGradStart);\n    lingrad.addColorStop(0.5, colorGradStart);\n    lingrad.addColorStop(0.5, colorGradEnd);\n    lingrad.addColorStop(1, colorGradEnd);\n    ctx.fillStyle = lingrad;\n    ctx.fillRect(\n      x + 1 * PIXEL_RATIO,\n      y + 1 * PIXEL_RATIO,\n      BLOCK_SIDE - 2 * PIXEL_RATIO,\n      BLOCK_SIDE - 2 * PIXEL_RATIO\n    );\n  }\n}\n","import { useRef, useEffect } from 'react';\n\nconst usePrevious = value => {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n};\n\nexport default usePrevious;\n","import { useMemo } from \"react\";\nimport usePrevious from \"../components/helpers/use-previous\";\nimport { getDifference } from \"../utils\";\n\nconst useRenderAreas = area => {\n  const prevArea = usePrevious(area);\n\n  const { renderArea, clearArea } = useMemo(\n    () => getDifference(area, prevArea),\n    [area, prevArea]\n  );\n\n  return {\n    renderArea,\n    clearArea\n  };\n};\n\nexport default useRenderAreas;\n","import React, { memo, useMemo, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport {\n  highScoreSelector,\n  scoreSelector,\n  activeFieldSelector,\n  gameStatusSelector\n} from '../../redux/selectors';\nimport {\n  NOT_STARTED,\n  GAME_PAUSED,\n  GAME_OVER,\n  BLOCK_SIDE,\n  PIXEL_RATIO\n} from '../../utils/consts';\nimport drawText from '../helpers/draw-text';\nimport useCanvas from '../../hooks/use-canvas';\nimport drawHighScore from '../helpers/draw-high-score';\nimport drawGameOver from '../helpers/draw-game-over';\nimport drawField from '../helpers/draw-field';\nimport { clearArea } from '../../utils';\nimport useRenderAreas from '../../hooks/use-render-areas';\n\nimport styles from './field.module.css';\n\nconst Field = () => {\n  const field = useSelector(state => activeFieldSelector(state));\n  const status = useSelector(state => gameStatusSelector(state));\n  const highScore = useSelector(state => highScoreSelector(state));\n  const score = useSelector(state => scoreSelector(state));\n\n  const canvasStyle = useMemo(\n    () => ({\n      width: 200,\n      height: 400,\n      position: 'absolute',\n      borderRadius: 10\n    }),\n    []\n  );\n\n  const {\n    renderArea: fieldRenderArea,\n    clearArea: fieldClearArea\n  } = useRenderAreas(field);\n\n  const fieldCanvas = useCanvas(\n    useCallback(\n      ctx => {\n        clearArea(ctx, fieldClearArea);\n        drawField({\n          field: fieldRenderArea,\n          ctx\n        });\n      },\n      [fieldClearArea, fieldRenderArea]\n    ),\n    canvasStyle\n  );\n\n  const textCanvas = useCanvas(\n    useCallback(\n      ctx => {\n        const color = '#eaeaea';\n        const position = [\n          (field[0].length * BLOCK_SIDE) / 2,\n          ((field.length - 5) / 2) * BLOCK_SIDE\n        ];\n        const center = [\n          (field[0].length * BLOCK_SIDE) / 2,\n          (field.length / 2) * BLOCK_SIDE\n        ];\n\n        switch (status) {\n          case NOT_STARTED:\n            drawHighScore({\n              highScore,\n              ctx,\n              size: 20,\n              position,\n              color\n            });\n\n            break;\n\n          case GAME_PAUSED:\n            drawText({\n              ctx,\n              size: 30,\n              position: center,\n              color,\n              text: 'PAUSED'\n            });\n\n            break;\n\n          case GAME_OVER:\n            drawGameOver({\n              ctx,\n              highScore: highScore.includes(score),\n              position,\n              color\n            });\n\n            break;\n\n          default:\n            return;\n        }\n      },\n      [field, highScore, score, status]\n    ),\n    {\n      ...canvasStyle,\n      background:\n        (status === NOT_STARTED || status === GAME_PAUSED) &&\n        'var(--bg-color-d)',\n      zIndex: 3\n    },\n    useCallback(\n      ctx => {\n        ctx.clearRect(\n          0,\n          0,\n          canvasStyle.width * PIXEL_RATIO,\n          canvasStyle.height * PIXEL_RATIO\n        );\n      },\n      [canvasStyle.height, canvasStyle.width]\n    )\n  );\n\n  return (\n    <div\n      className={`${styles['canvas-container']} ${styles['canvas-container__dark']}`}\n      style={{ height: 400 }}\n    >\n      {textCanvas}\n      {fieldCanvas}\n    </div>\n  );\n};\n\nexport default memo(Field);\n","import { colors, BLOCK_SIDE } from '../../utils/consts';\nimport drawBlock from './draw-block';\nimport { lightenColor } from '../../utils';\n\nexport default function drawField({ field, ctx }) {\n  field.forEach((row, ri) => {\n    row.forEach((col, ci) => {\n      if (!col) return;\n\n      const position = [ci * BLOCK_SIDE, ri * BLOCK_SIDE];\n      const color =\n        col > colors.length ? lightenColor(colors[col - 8], 75) : colors[col];\n      const ghost = !color;\n\n      drawBlock({ ctx, BLOCK_SIDE, position, color, ghost });\n    });\n  });\n}\n","import drawText from \"./draw-text\";\nimport { PIXEL_RATIO } from \"../../utils/consts\";\n\nexport default function drawHighScore({\n  highScore = [],\n  ctx,\n  color,\n  position,\n  size\n}) {\n  const highScores = highScore.reduce(\n    (res, val, i) =>\n      val\n        ? res.concat(\n            drawText({\n              ctx,\n              size,\n              position: [position[0], position[1] + 30 * PIXEL_RATIO * (i + 2)],\n              color,\n              text: `${i + 1}: ${val}`\n            })\n          )\n        : res,\n    []\n  );\n  if (highScores.length) {\n    drawText({\n      ctx,\n      size: 30,\n      position,\n      color,\n      text: \"PRESS START\"\n    });\n    drawText({\n      ctx,\n      size: 20,\n      position: [position[0], position[1] + 30 * PIXEL_RATIO],\n      color,\n      text: \"HIGH SCORES:\"\n    });\n  } else {\n    drawText({\n      ctx,\n      size: 30,\n      position: [position[0], position[1] + 50 * PIXEL_RATIO],\n      color,\n      text: \"PRESS START\"\n    });\n  }\n}\n","import drawText from \"./draw-text\";\nimport { PIXEL_RATIO } from \"../../utils/consts\";\n\nexport default function drawGameOver({\n  ctx,\n  color,\n  position,\n  highScore = false\n}) {\n  if (highScore) {\n    drawText({\n      ctx,\n      size: 30,\n      position,\n      color,\n      text: \"GAME OVER\"\n    });\n    drawText({\n      ctx,\n      size: 30,\n      position: [position[0], position[1] + 40 * PIXEL_RATIO],\n      color,\n      text: \"NEW\"\n    });\n    drawText({\n      ctx,\n      size: 30,\n      position: [position[0], position[1] + 80 * PIXEL_RATIO],\n      color,\n      text: \"HIGH SCORE!\"\n    });\n  } else {\n    drawText({\n      ctx,\n      size: 30,\n      position: [position[0], position[1] + 60 * PIXEL_RATIO],\n      color,\n      text: \"GAME OVER\"\n    });\n  }\n}\n","import React, { memo, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { nextBlockSelector, gameStatusSelector } from '../../redux/selectors';\nimport drawTetrimino from '../helpers/draw-tetrimino';\nimport useCanvas from '../../hooks/use-canvas';\nimport { PIXEL_RATIO, BLOCK_SIDE, NOT_STARTED } from '../../utils/consts';\nimport { clearArea } from '../../utils';\n\nimport styles from '../field/field.module.css';\n\nconst NextBlock = () => {\n  const width = 100;\n  const height = 100;\n  const nextBlock = useSelector(state =>\n    nextBlockSelector(\n      state,\n      width * PIXEL_RATIO,\n      height * PIXEL_RATIO,\n      BLOCK_SIDE\n    )\n  );\n  const status = useSelector(state => gameStatusSelector(state));\n\n  const canvas = useCanvas(\n    useCallback(\n      ctx => {\n        if (status !== NOT_STARTED) {\n          drawTetrimino({\n            block: nextBlock,\n            ctx,\n            startingRow: 0\n          });\n        }\n      },\n      [nextBlock, status]\n    ),\n    { width, height },\n    useCallback(\n      ctx => {\n        clearArea(ctx, nextBlock.shape, nextBlock.position);\n      },\n      [nextBlock.position, nextBlock.shape]\n    )\n  );\n\n  return (\n    <div\n      className={`${styles['canvas-container']} ${styles['canvas-container__dark']}`}\n    >\n      <div className={styles.text}>Next block</div>\n      {canvas}\n    </div>\n  );\n};\n\nexport default memo(NextBlock);\n","import { INVISIBLE_ROWS, BLOCK_SIDE } from \"../../utils/consts\";\nimport { getShapeColor } from \"../../utils\";\nimport drawBlock from \"./draw-block\";\n\nexport default function drawTetrimino({\n  block,\n  ctx,\n  startingRow = INVISIBLE_ROWS,\n  offset = [0, 0],\n  ghost = false\n}) {\n  if (!block) return;\n  const { shape, position, locked } = block;\n  const [x, y] = position;\n  let color = getShapeColor(shape);\n\n  shape.forEach((row, ri) =>\n    row.forEach((col, ci) => {\n      if (!col) return;\n      const position = [\n        x * BLOCK_SIDE + ci * BLOCK_SIDE + offset[0],\n        y * BLOCK_SIDE + (ri - startingRow) * BLOCK_SIDE + offset[1]\n      ];\n      drawBlock({ ctx, position, color, locked, ghost });\n    })\n  );\n}\n","import { useState, useEffect, useRef, useCallback } from \"react\";\n\nconst now = () => new Date().getTime();\n\nexport default function useInterval(callback, ms) {\n  const [remaining, setRemaining] = useState(0);\n  const [startTime, setStartTime] = useState(now());\n  const [paused, setPaused] = useState(true);\n  const savedCallback = useRef();\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  const start = useCallback(() => {\n    setStartTime(now());\n    setPaused(false);\n  }, []);\n\n  const pause = useCallback(() => {\n    setPaused(true);\n    setRemaining(ms - (now() - startTime));\n    setStartTime(now());\n  }, [ms, startTime]);\n\n  const resume = useCallback(() => {\n    if (paused) {\n      setPaused(false);\n      setStartTime(now());\n    }\n  }, [paused]);\n\n  const reset = useCallback(() => {\n    setPaused(false);\n    setRemaining(ms);\n    setStartTime(now());\n  }, [ms]);\n\n  useEffect(() => {\n    const interval = setInterval(\n      () => {\n        savedCallback.current();\n        setRemaining(0);\n        setStartTime(now());\n      },\n      remaining ? remaining : ms\n    );\n\n    if (paused) {\n      clearInterval(interval);\n    }\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [ms, paused, remaining]);\n\n  return {\n    start,\n    pause,\n    resume,\n    reset\n  };\n}\n","import { mergeMatrix } from '../../utils';\nimport { RESET } from './game-state';\n\nexport const MERGE = 'MERGE';\nexport const DESTROY_ROW = 'DESTROY_ROW';\nconst defaultState = [\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n];\n\nexport default (state = defaultState, action) => {\n  const { type, payload } = action;\n\n  switch (type) {\n    case MERGE:\n      const { shape, position } = payload;\n\n      return mergeMatrix(state, shape, position);\n\n    case DESTROY_ROW:\n      return payload;\n\n    case RESET:\n      return defaultState;\n\n    default:\n      return state;\n  }\n};\n\nexport const mergeField = payload => ({\n  type: MERGE,\n  payload\n});\n\nexport const destroyRow = payload => ({\n  type: DESTROY_ROW,\n  payload\n});\n","import {\n  IN_PROGRESS,\n  GAME_OVER,\n  GAME_PAUSED,\n  NOT_STARTED\n} from \"../../utils/consts\";\nimport { MERGE } from \"./field\";\nimport { calcNewScore, calcLevel, calcSpeed } from \"../../utils\";\n\nexport const START = \"START\";\nexport const DEFEAT = \"DEFEAT\";\nexport const ROWS_DESTROYED = \"ROWS_DESTROYED\";\nexport const PAUSE = \"PAUSE\";\nexport const RESUME = \"RESUME\";\nexport const RESET = \"RESET\";\nexport const TOGGLE_PAUSE = \"TOGGLE_PAUSE\";\n\nconst defaultState = {\n  status: NOT_STARTED,\n  lastAction: null,\n  level: 1,\n  score: 0,\n  lines: 0,\n  speed: 100\n};\n\nexport default (state = defaultState, action) => {\n  const { type, lines } = action;\n  switch (type) {\n    case START:\n      return { ...defaultState, status: IN_PROGRESS, lastAction: START };\n    case MERGE:\n      return { ...state, score: state.score + 10, lastAction: MERGE };\n    case DEFEAT:\n      return { ...state, status: GAME_OVER, lastAction: DEFEAT };\n    case ROWS_DESTROYED:\n      const newLevel = calcLevel(state.lines + lines);\n      const newSpeed = calcSpeed(newLevel);\n      return {\n        ...state,\n        lines: state.lines + lines,\n        score: calcNewScore({ ...state, lines }),\n        level: newLevel,\n        speed: newSpeed,\n        lastAction: ROWS_DESTROYED\n      };\n    case PAUSE:\n      return { ...state, status: GAME_PAUSED, lastAction: PAUSE };\n    case RESUME:\n      return { ...state, status: IN_PROGRESS, lastAction: RESUME };\n    case RESET:\n      return { ...defaultState, status: IN_PROGRESS, lastAction: RESET };\n    default:\n      return state;\n  }\n};\n\nexport const start = () => ({\n  type: START\n});\n\nexport const gameOver = () => ({\n  type: DEFEAT\n});\n\nexport const rowsDestroyed = lines => ({\n  type: ROWS_DESTROYED,\n  lines\n});\n\nexport const togglePause = () => ({\n  type: TOGGLE_PAUSE\n});\n\nexport const reset = () => ({\n  type: RESET\n});\n\nexport const pause = () => ({\n  type: PAUSE\n});\n\nexport const resume = () => ({\n  type: RESUME\n});\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState, useCallback, memo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport {\n  levelSelector,\n  scoreSelector,\n  linesSelector,\n  gameStateSelector\n} from \"../../redux/selectors\";\nimport NextBlock from \"../next-block\";\nimport useInterval from \"../../hooks/use-interval\";\nimport {\n  START,\n  RESET,\n  PAUSE,\n  RESUME,\n  DEFEAT\n} from \"../../redux/ducks/game-state\";\nimport canvasStyles from \"../field/field.module.css\";\nimport styles from \"./info.module.css\";\nimport { timeFromMs } from \"../../utils\";\n\nconst Info = () => {\n  const { level, score, lines, gameState } = useSelector(state => ({\n    level: levelSelector(state),\n    score: scoreSelector(state),\n    lines: linesSelector(state),\n    gameState: gameStateSelector(state)\n  }));\n  const { lastAction } = gameState;\n  const [time, setTime] = useState(0);\n  const incrementTime = useCallback(() => {\n    setTime(time => time + 1);\n  }, []);\n  const { start, pause, resume, reset } = useInterval(incrementTime, 1000);\n\n  useEffect(() => {\n    if (lastAction === START) {\n      start();\n    }\n    if (lastAction === RESET) {\n      reset();\n      setTime(0);\n    }\n    if (lastAction === PAUSE || lastAction === DEFEAT) {\n      pause();\n    }\n    if (lastAction === RESUME) {\n      resume();\n    }\n  }, [gameState]);\n\n  return (\n    <div className={styles[\"info-column\"]}>\n      <div\n        className={`${canvasStyles[\"canvas-container\"]} ${canvasStyles[\"canvas-container__dark\"]} ${styles.info}`}\n      >\n        <div>{`Level: ${level}`}</div>\n        <div>{`Score: ${score}`}</div>\n        <div>{`Lines: ${lines}`}</div>\n        <div>{`Time: ${timeFromMs(time)}`}</div>\n      </div>\n      <NextBlock />\n    </div>\n  );\n};\n\nexport default memo(Info);\n","import React, { memo } from \"react\";\nimport styles from \"./display.module.css\";\nimport Field from \"../field\";\nimport Info from \"../info\";\n\nconst Display = () => (\n  <div className={styles[\"display-container\"]}>\n    <Field />\n    <Info />\n  </div>\n);\n\nexport default memo(Display);\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport { useEffect, useState, useCallback } from \"react\";\nimport { isMobileDevice } from \"../utils\";\n\nconst mouseUp = isMobileDevice ? \"touchend\" : \"mouseup\";\nconst mouseDown = isMobileDevice ? \"touchstart\" : \"mousedown\";\n\nconst isKeyClicked = (targetKey, key) =>\n  targetKey && key && key.toLowerCase() === targetKey.toLowerCase();\n\nconst isButtonClicked = (targetButton, e, type) =>\n  targetButton && e.type === type && targetButton.current.contains(e.target);\n\nexport default function useKey({\n  targetKey,\n  callback,\n  continious = false,\n  targetButton = false,\n  frequency = 100,\n  delay = 200\n}) {\n  const [pressed, setPressed] = useState(false);\n\n  const onDown = useCallback(\n    e => {\n      const { key } = e;\n      if (\n        isKeyClicked(targetKey, key) ||\n        isButtonClicked(targetButton, e, mouseDown)\n      ) {\n        e.preventDefault();\n        setPressed(true);\n      }\n    },\n    [targetKey]\n  );\n\n  const onUp = useCallback(\n    e => {\n      const { key } = e;\n      if (\n        isKeyClicked(targetKey, key) ||\n        isButtonClicked(targetButton, e, mouseUp)\n      ) {\n        e.preventDefault();\n        setPressed(false);\n      }\n    },\n    [targetKey]\n  );\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", onDown);\n    window.addEventListener(\"keyup\", onUp);\n\n    if (targetButton) {\n      window.addEventListener(mouseDown, onDown);\n      window.addEventListener(mouseUp, onUp);\n    }\n\n    return () => {\n      window.removeEventListener(\"keydown\", onDown);\n      window.removeEventListener(\"keydup\", onUp);\n\n      if (targetButton) {\n        window.addEventListener(mouseDown, onDown);\n        window.addEventListener(mouseUp, onUp);\n      }\n    };\n  }, [targetKey]);\n\n  useEffect(() => {\n    let interval, timeout;\n\n    if (!callback) return;\n\n    if (pressed) callback();\n\n    if (continious) {\n      timeout = setTimeout(\n        () =>\n          (interval = setInterval(() => {\n            if (pressed && continious) {\n              callback();\n            }\n          }, frequency)),\n        delay\n      );\n    }\n\n    return () => {\n      clearTimeout(timeout);\n      clearInterval(interval);\n    };\n  }, [pressed, continious, delay]);\n\n  return pressed;\n}\n","import React, { memo } from \"react\";\nimport styles from \"./button.module.css\";\n\nconst OptionButton = ({ style, text, pressed, btnRef }) => (\n  <div style={style} className={`${styles[\"button-container\"]}`}>\n    <button\n      className={`\n        ${styles[\"tetris-option-button\"]} ${\n        styles[\"tetris-option-button__dark\"]\n      }\n        ${pressed && styles[\"tetris-option-button__active\"]} ${pressed &&\n        styles[\"tetris-option-button__dark__active\"]}\n        `}\n      ref={btnRef}\n    ></button>\n    <div>{text}</div>\n  </div>\n);\n\nexport default memo(OptionButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { reset } from \"../../redux/ducks/game-state\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport OptionButton from \"./option-button\";\n\nconst StartButton = ({ style }) => {\n  const dispatch = useDispatch();\n  const startGame = () => dispatch(reset());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"s\",\n    callback: startGame,\n    targetButton\n  });\n\n  return (\n    <OptionButton\n      style={style}\n      btnRef={targetButton}\n      pressed={pressed}\n      text=\"Start\"\n    />\n  );\n};\n\nexport default memo(StartButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { togglePause } from \"../../redux/ducks/game-state\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport OptionButton from \"./option-button\";\n\nconst PauseButton = ({ style }) => {\n  const dispatch = useDispatch();\n  const togglePauseGame = () => dispatch(togglePause());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"p\",\n    callback: togglePauseGame,\n    targetButton\n  });\n\n  return (\n    <OptionButton\n      style={style}\n      btnRef={targetButton}\n      pressed={pressed}\n      text=\"Pause\"\n    />\n  );\n};\n\nexport default memo(PauseButton);\n","import { getNewTetrimino } from '../../utils';\nimport { RESET } from './game-state';\nimport { DEFAULT_SHAPE } from '../../utils/consts';\n\nexport const ROTATE = 'active-block/ROTATE';\nexport const MOVE_RIGHT = 'active-block/MOVE_RIGHT';\nexport const MOVE_LEFT = 'active-block/MOVE_LEFT';\nexport const MOVE_DOWN = 'active-block/MOVE_DOWN';\nexport const SET_NEW_TETRIMINO = 'active-block/SET_NEW_TETRIMINO';\nexport const LOCK = 'active-block/LOCK';\nexport const UNLOCK = 'active-block/UNLOCK';\nexport const DROP = 'active-block/DROP';\nexport const MOVE_LOCK = 'active-block/MOVE_LOCK';\nexport const MOVE_UNLOCK = 'active-block/MOVE_UNLOCK';\n\nexport default (state = DEFAULT_SHAPE, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    case ROTATE:\n      return payload ? payload : state;\n\n    case MOVE_LEFT:\n      return { ...state, position: [state.position[0] - 1, state.position[1]] };\n\n    case MOVE_RIGHT:\n      return { ...state, position: [state.position[0] + 1, state.position[1]] };\n\n    case MOVE_DOWN:\n      return { ...state, position: [state.position[0], state.position[1] + 1] };\n\n    case SET_NEW_TETRIMINO:\n      return payload;\n\n    case RESET:\n      return getNewTetrimino();\n\n    case LOCK:\n      return { ...state, locked: true };\n\n    case UNLOCK:\n      return { ...state, locked: false };\n\n    case MOVE_LOCK:\n      return { ...state, movementLocked: true };\n\n    case MOVE_UNLOCK:\n      return { ...state, movementLocked: false };\n\n    default:\n      return state;\n  }\n};\n\nexport const moveRight = () => ({\n  type: MOVE_RIGHT\n});\n\nexport const moveLeft = () => ({\n  type: MOVE_LEFT\n});\n\nexport const moveDown = () => ({\n  type: MOVE_DOWN\n});\n\nexport const rotate = payload => ({\n  type: ROTATE,\n  payload\n});\n\nexport const setNewTetrimino = payload => ({\n  type: SET_NEW_TETRIMINO,\n  payload\n});\n\nexport const lock = () => ({\n  type: LOCK\n});\n\nexport const unlock = () => ({\n  type: UNLOCK\n});\n\nexport const drop = () => ({\n  type: DROP\n});\n\nexport const movementLock = () => ({\n  type: MOVE_LOCK\n});\n\nexport const movementUnlock = () => ({\n  type: MOVE_UNLOCK\n});\n","import React, { memo } from \"react\";\nimport styles from \"./button.module.css\";\n\nconst MainButton = ({ style, btnRef, pressed, text }) => (\n  <div style={style} className={`${styles[\"button-container\"]}`} ref={btnRef}>\n    <button\n      className={`\n        ${styles[\"tetris-button\"]} ${styles[\"tetris-button__dark\"]}\n        ${pressed && styles[\"tetris-button__active\"]} ${pressed &&\n        styles[\"tetris-button__dark__active\"]}\n        `}\n      tabIndex=\"-1\"\n    ></button>\n    <span>{text}</span>\n  </div>\n);\n\nexport default memo(MainButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport { moveLeft } from \"../../redux/ducks/active-block\";\nimport MainButton from \"./main-button\";\n\nconst LeftButton = ({ style }) => {\n  const dispatch = useDispatch();\n  const callback = () => dispatch(moveLeft());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"ArrowLeft\",\n    callback,\n    continious: true,\n    targetButton\n  });\n\n  return (\n    <MainButton\n      style={style}\n      btnRef={targetButton}\n      pressed={pressed}\n      text=\"Left\"\n    />\n  );\n};\n\nexport default memo(LeftButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport { moveRight } from \"../../redux/ducks/active-block\";\nimport MainButton from \"./main-button\";\n\nconst RightButton = ({ style }) => {\n  const dispatch = useDispatch();\n  const callback = () => dispatch(moveRight());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"ArrowRight\",\n    callback,\n    continious: true,\n    targetButton\n  });\n\n  return (\n    <MainButton\n      style={style}\n      pressed={pressed}\n      btnRef={targetButton}\n      text=\"Right\"\n    />\n  );\n};\n\nexport default memo(RightButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport { rotate } from \"../../redux/ducks/active-block\";\nimport MainButton from \"./main-button\";\n\nconst RotateButton = ({ style }) => {\n  const dispatch = useDispatch();\n  const rotateBlock = () => dispatch(rotate());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"ArrowUp\",\n    callback: rotateBlock,\n    targetButton\n  });\n\n  return (\n    <MainButton\n      style={style}\n      btnRef={targetButton}\n      pressed={pressed}\n      text=\"Rotate\"\n    />\n  );\n};\n\nexport default memo(RotateButton);\n","import React, { useRef, useEffect, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport {\n  moveDown,\n  movementLock,\n  movementUnlock\n} from \"../../redux/ducks/active-block\";\nimport MainButton from \"./main-button\";\n\nfunction DownButton({ style }) {\n  const dispatch = useDispatch();\n  const callback = () => dispatch(moveDown());\n  const targetButton = useRef();\n  const pressed = useKeyPress({\n    targetKey: \"ArrowDown\",\n    callback,\n    continious: true,\n    frequency: 75,\n    targetButton\n  });\n\n  useEffect(() => {\n    dispatch(pressed ? movementLock() : movementUnlock());\n  }, [dispatch, pressed]);\n\n  return (\n    <MainButton\n      style={style}\n      pressed={pressed}\n      btnRef={targetButton}\n      text=\"Down\"\n    />\n  );\n}\n\nexport default memo(DownButton);\n","import React, { useRef, memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport { drop } from \"../../redux/ducks/active-block\";\nimport MainButton from \"./main-button\";\n\nfunction DropButton({ style }) {\n  const dispatch = useDispatch();\n  const targetButton = useRef();\n  const dropBlock = () => dispatch(drop());\n  const pressed = useKeyPress({\n    targetKey: \" \",\n    callback: dropBlock,\n    targetButton\n  });\n\n  return (\n    <MainButton\n      style={style}\n      btnRef={targetButton}\n      pressed={pressed}\n      text=\"Drop\"\n    />\n  );\n}\n\nexport default memo(DropButton);\n","import React, { memo } from \"react\";\nimport Start from \"./start\";\nimport Pause from \"./pause\";\nimport styles from \"./button.module.css\";\nimport Left from \"./left\";\nimport Right from \"./right\";\nimport Rotate from \"./rotate\";\nimport Down from \"./down\";\nimport Drop from \"./drop\";\n\nconst Buttons = () => (\n  <div className={styles[\"buttons-container\"]}>\n    <Start style={{ gridArea: \"start\" }} />\n    <Pause style={{ gridArea: \"pause\" }} />\n    <Rotate style={{ gridArea: \"start / start / rotate / rotate\" }} />\n    <Left style={{ gridArea: \"left\" }} />\n    <Down style={{ gridArea: \"down\" }} />\n    <Right style={{ gridArea: \"right\" }} />\n    <Drop style={{ gridArea: \"drop\" }} />\n  </div>\n);\n\nexport default memo(Buttons);\n","import { useEffect } from \"react\";\n\nconst useTabChange = callback => {\n  useEffect(() => {\n    document.addEventListener(\"visibilitychange\", callback);\n    return () => {\n      document.removeEventListener(\"visibilitychange\", callback);\n    };\n  }, [callback]);\n};\n\nexport default useTabChange;\n","import React, { memo } from \"react\";\nimport { useDispatch } from \"react-redux\";\n\nimport Display from \"../display\";\nimport Buttons from \"../buttons\";\nimport useTabChange from \"../../hooks/use-tab-change\";\nimport { pause } from \"../../redux/ducks/game-state\";\n\nimport styles from \"./game.module.css\";\n\nconst Game = () => {\n  const dispatch = useDispatch();\n  const callback = () => dispatch(pause());\n  useTabChange(callback);\n  return (\n    <div\n      className={`${styles[\"tetris-container\"]} ${styles[\"tetris-container__dark\"]}`}\n    >\n      <Display />\n      <Buttons />\n    </div>\n  );\n};\n\nexport default memo(Game);\n","import { combineReducers } from \"redux\";\nimport activeBlock from \"../ducks/active-block\";\nimport field from \"../ducks/field\";\nimport nextBlock from \"../ducks/next-block\";\nimport gameState from \"../ducks/game-state\";\nimport highScore from \"../ducks/high-score\";\n\nexport default combineReducers({\n  activeBlock,\n  field,\n  nextBlock,\n  gameState,\n  highScore\n});\n","import { SET_NEW_TETRIMINO } from \"./active-block\";\nimport { RESET } from \"./game-state\";\nimport { getNewTetrimino } from \"../../utils\";\nimport { DEFAULT_SHAPE } from \"../../utils/consts\";\n\nexport default (state = DEFAULT_SHAPE, action) => {\n  const { type } = action;\n  switch (type) {\n    case SET_NEW_TETRIMINO:\n      return getNewTetrimino();\n    case RESET:\n      return getNewTetrimino();\n    default:\n      return state;\n  }\n};\n","export const NEW_HIGH_SCORE = \"NEW_HIGH_SCORE\";\n\nexport default (state = [0, 0, 0, 0, 0], action) => {\n  const { type, payload } = action;\n  switch (type) {\n    case NEW_HIGH_SCORE:\n      return state\n        .concat(payload)\n        .sort((a, b) => b - a)\n        .slice(0, 5);\n    default:\n      return state;\n  }\n};\n\nexport const setNewHighScore = payload => ({\n  type: NEW_HIGH_SCORE,\n  payload\n});\n","import { GAME_OVER, GAME_PAUSED, NOT_STARTED } from '../../utils/consts';\nimport { TOGGLE_PAUSE, RESET, START } from '../ducks/game-state';\n\nconst alwaysDispatch = [START, RESET];\n\nexport default store => next => action => {\n  const { status } = store.getState().gameState;\n  const { type } = action;\n\n  if (alwaysDispatch.includes(type)) return next(action);\n\n  if (\n    status === GAME_OVER ||\n    status === NOT_STARTED ||\n    (status === GAME_PAUSED && type !== TOGGLE_PAUSE)\n  ) {\n    return;\n  }\n\n  return next(action);\n};\n","import {\n  MOVE_LEFT,\n  MOVE_RIGHT,\n  MOVE_DOWN,\n  ROTATE,\n  unlock,\n  lock\n} from \"../ducks/active-block\";\nimport { canMoveDown } from \"../../utils\";\nimport { fieldSelector, blockSelector } from \"../selectors\";\n\nconst actions = [MOVE_LEFT, MOVE_RIGHT, MOVE_DOWN, ROTATE];\n\nexport default store => next => action => {\n  const { type } = action;\n\n  if (!actions.includes(type)) return next(action);\n\n  next(action);\n\n  const block = blockSelector(store.getState());\n  const { locked } = block;\n  const field = fieldSelector(store.getState());\n  const isMovingDown = canMoveDown(field, block);\n\n  if (locked && isMovingDown) {\n    next(unlock());\n  }\n\n  if (!locked && !isMovingDown) {\n    next(lock());\n  }\n};\n","import { createStore, applyMiddleware, compose } from \"redux\";\nimport reducer from \"../reduser\";\nimport collisionCheck from \"../middlewares/collision-check\";\nimport destroyRow from \"../middlewares/destroy-row\";\nimport gameStateChecker from \"../middlewares/game-state-checker\";\nimport blockLocker from \"../middlewares/block-locker\";\nimport pauseToggle from \"../middlewares/pause-toggle\";\nimport moveDown from \"../middlewares/move-down\";\nimport { loadHighScore } from \"../../localstorage\";\n\nconst middlewares = [\n  gameStateChecker,\n  pauseToggle,\n  moveDown,\n  collisionCheck,\n  blockLocker,\n  destroyRow\n];\nconst isDev = process.env.NODE_ENV === \"development\";\nconst highScore = loadHighScore();\nconst enhancer = applyMiddleware(...middlewares);\nconst devTools = window.__REDUX_DEVTOOLS_EXTENSION__\n  ? window.__REDUX_DEVTOOLS_EXTENSION__()\n  : f => f;\nconst store = createStore(\n  reducer,\n  { ...reducer, highScore },\n  isDev ? compose(enhancer, devTools) : enhancer\n);\n\nexport default store;\n","import { TOGGLE_PAUSE, resume, pause } from '../ducks/game-state';\nimport { GAME_PAUSED, IN_PROGRESS } from '../../utils/consts';\n\nexport default store => next => action => {\n  const { type } = action;\n\n  if (type === TOGGLE_PAUSE) {\n    const { status } = store.getState().gameState;\n\n    if (status === GAME_PAUSED) {\n      return next(resume());\n    } else {\n      if (status === IN_PROGRESS) return next(pause());\n    }\n  }\n\n  return next(action);\n};\n","import { moveDown, MOVE_LOCK, MOVE_UNLOCK } from '../ducks/active-block';\nimport {\n  RESET,\n  PAUSE,\n  RESUME,\n  DEFEAT,\n  ROWS_DESTROYED\n} from '../ducks/game-state';\nimport { Interval } from '../../utils';\nimport { speedSelector } from '../selectors';\n\nexport default store => next => action => {\n  const callback = () => next(moveDown());\n  const { type } = action;\n\n  switch (type) {\n    case RESET:\n      next(action);\n      Interval.set(callback, speedSelector(store.getState()));\n\n      break;\n\n    case PAUSE:\n      Interval.pause(callback);\n\n      return next(action);\n\n    case RESUME:\n      Interval.resume(callback);\n\n      return next(action);\n\n    case DEFEAT:\n      Interval.clear(callback);\n\n      return next(action);\n\n    case MOVE_LOCK:\n      Interval.clear(callback);\n\n      return next(action);\n\n    case MOVE_UNLOCK:\n      Interval.set(callback, speedSelector(store.getState()));\n\n      return next(action);\n\n    case ROWS_DESTROYED:\n      const speedBefore = speedSelector(store.getState());\n\n      next(action);\n\n      const speedAfter = speedSelector(store.getState());\n\n      if (speedBefore !== speedAfter) {\n        Interval.clear(callback);\n        Interval.set(callback, speedAfter);\n      }\n\n      break;\n\n    default:\n      return next(action);\n  }\n};\n","import {\n  canMoveLeft,\n  canMoveRight,\n  rotateTetrimino,\n  getGhostBlock\n} from \"../../utils\";\nimport {\n  MOVE_DOWN,\n  MOVE_LEFT,\n  MOVE_RIGHT,\n  ROTATE,\n  rotate,\n  DROP\n} from \"../ducks/active-block\";\nimport { mergeField } from \"../ducks/field\";\nimport { fieldSelector, blockSelector } from \"../selectors\";\n\nexport default store => next => action => {\n  const { type } = action;\n\n  switch (type) {\n    case MOVE_LEFT: {\n      const state = store.getState();\n      const field = fieldSelector(state);\n      const block = blockSelector(state);\n      const isMovingLeft = canMoveLeft(field, block);\n\n      if (isMovingLeft) {\n        next(action);\n      }\n\n      break;\n    }\n\n    case MOVE_RIGHT: {\n      const state = store.getState();\n      const field = fieldSelector(state);\n      const block = blockSelector(state);\n      const isMovingRight = canMoveRight(field, block);\n\n      if (isMovingRight) {\n        next(action);\n      }\n\n      break;\n    }\n\n    case MOVE_DOWN: {\n      const state = store.getState();\n      const block = blockSelector(state);\n      const { locked } = block;\n\n      if (locked) return;\n\n      return next(action);\n    }\n\n    case DROP: {\n      const state = store.getState();\n      const { field, activeBlock } = state;\n      const { position } = getGhostBlock(field, activeBlock);\n      const block = { shape: activeBlock.shape, position };\n\n      return next(mergeField(block));\n    }\n\n    case ROTATE: {\n      const state = store.getState();\n      const { field, activeBlock } = state;\n\n      next(rotate(rotateTetrimino(field, activeBlock)));\n\n      break;\n    }\n\n    default:\n      return next(action);\n  }\n};\n","import { MERGE, destroyRow, mergeField } from \"../ducks/field\";\nimport { destroyFullRows, collide, canMoveDown, Timeout } from \"../../utils\";\nimport {\n  rowsDestroyed,\n  gameOver,\n  PAUSE,\n  RESUME,\n  TOGGLE_PAUSE\n} from \"../ducks/game-state\";\nimport {\n  SET_NEW_TETRIMINO,\n  setNewTetrimino,\n  unlock,\n  LOCK,\n  UNLOCK\n} from \"../ducks/active-block\";\nimport { LOCK_DELAY, GAME_PAUSED, IN_PROGRESS } from \"../../utils/consts\";\nimport { saveHighScore } from \"../../localstorage\";\nimport { scoreSelector, highScoreSelector } from \"../selectors\";\nimport { setNewHighScore } from \"../ducks/high-score\";\n\nexport default store => next => action => {\n  const { type } = action;\n  const nextBlock = store.getState().nextBlock;\n  const dispatchMerge = () => {\n    store.dispatch(mergeField(store.getState().activeBlock));\n  };\n\n  switch (type) {\n    case LOCK:\n      Timeout.set(dispatchMerge, LOCK_DELAY);\n\n      return next(action);\n\n    case UNLOCK:\n      Timeout.clear(dispatchMerge);\n\n      return next(action);\n\n    case TOGGLE_PAUSE:\n      const isPaused = store.getState().gameState.status === GAME_PAUSED;\n\n      if (isPaused) {\n        Timeout.resume(dispatchMerge);\n      } else {\n        const isRunning = store.getState().gameState.status === IN_PROGRESS;\n        if (isRunning) Timeout.pause(dispatchMerge);\n      }\n\n      return next(action);\n\n    case PAUSE:\n      Timeout.pause(dispatchMerge);\n\n      return next(action);\n\n    case RESUME:\n      Timeout.resume(dispatchMerge);\n\n      return next(action);\n\n    case MERGE:\n      const { payload } = action;\n      const { field } = store.getState();\n      const isMovingDown = canMoveDown(field, payload);\n\n      if (isMovingDown) {\n        return next(unlock());\n      }\n\n      next(action);\n\n      const mergedField = store.getState().field;\n      const { matrix, rows } = destroyFullRows(mergedField);\n\n      next(destroyRow(matrix));\n\n      if (rows > 0) {\n        store.dispatch(rowsDestroyed(rows));\n      }\n\n      return store.dispatch(setNewTetrimino(nextBlock));\n\n    case SET_NEW_TETRIMINO: {\n      const state = store.getState();\n      const { field, nextBlock } = state;\n\n      if (collide(field, nextBlock)) {\n        const score = scoreSelector(state);\n        const highScore = highScoreSelector(state);\n\n        if (highScore.reduce((res, val) => (res ? res : val < score), false)) {\n          next(setNewHighScore(score));\n          saveHighScore(highScoreSelector(store.getState()));\n        }\n\n        next(unlock());\n\n        return store.dispatch(gameOver());\n      }\n\n      next(action);\n\n      break;\n    }\n    default:\n      return next(action);\n  }\n};\n","export const loadHighScore = () => {\n  try {\n    const serializedHighScore = localStorage.getItem(\"highScore\");\n    if (serializedHighScore === null) {\n      return [0, 0, 0, 0, 0];\n    }\n    return JSON.parse(serializedHighScore);\n  } catch (err) {\n    return [0, 0, 0, 0, 0];\n  }\n};\n\nexport const saveHighScore = score => {\n  const serializedHighScore = JSON.stringify(score);\n  localStorage.setItem(\"highScore\", serializedHighScore);\n};\n","import React, { memo } from \"react\";\nimport { version } from \"../../../package.json\";\n\nimport styles from \"./styles.module.css\";\n\nconst Version = () => <div className={styles.version}>v{version}</div>;\n\nexport default memo(Version);\n","import React from \"react\";\nimport Game from \"./components/game\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store\";\nimport Version from \"./components/version\";\n\nimport \"./App.css\";\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <Game />\n      <Version />\n    </Provider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { isMobileDevice } from './utils';\nimport './index.css';\n\nif (isMobileDevice) {\n  document.addEventListener('touchend', e => {\n    e.preventDefault();\n  });\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.register();\n"],"sourceRoot":""}